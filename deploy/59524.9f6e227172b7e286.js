"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[59524],{59524:(At,_,a)=>{a.r(_),a.d(_,{NotificationGroupingRecordsModule:()=>Mt});var d=a(96814),b=a(23758),p=a(35461),c=a(93116);const J=[{type:"buttons",fixed:!0,alignment:"left",buttons:[{name:"detail",template:"grid-table-list-button"},{name:"repush",template:"repush"}]},{name:"id",visible:!1},{name:"concurrencyStamp",visible:!1},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:p.I.text},{name:"typeShow",caption:"\u578b\u614b",dataType:"string",filterOperations:p.I.text},{name:"notificationInfoName",caption:"\u540d\u7a31",dataType:"string",filterOperations:p.I.text},{name:"notificationProviders",caption:"\u63d0\u4f9b\u8005",dataType:"object",calculateDisplayValue:i=>i.notificationProviders.map(s=>s.displayName).join("\u3001")},{name:"notificationSchedulePlans",caption:"\u6642\u9593\u8a08\u756b",dataType:"object",calculateDisplayValue:i=>0===i.type?(0,c.m)(i.notificationSchedulePlans[0].pushTime):1===i.type?i.notificationSchedulePlans.map(s=>(0,c.m)(s.pushTime)+` (${s.name})`).join("\u3001"):2===i.type?i.notificationSchedulePlans.map(s=>s.name?s.cronDescription+` (${s.name})`:s.cronDescription).join("\u3001"):void 0},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:p.I.text},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",visible:!1},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",visible:!1},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",visible:!1},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1},{dataField:"htmlContent",caption:"HTML \u5167\u5bb9",dataType:"string",visible:!1},{type:"detailExpand",fixed:!0,fixedPosition:"right"}],v={index:"/api/app/jbnotifier-admin/notification-grouping-records"},O=[{dataField:"notificationCategoryId",path:"/api/app/notification-infos/assignable-notification-categories",pathForSelectedDisplay:"/api/app/notification-categories"}],y=[{name:"id",mapping:["notificationInfo","id"]},{name:"concurrencyStamp",mapping:["notificationInfo","concurrencyStamp"]},{name:"tenantName",mapping:["tenant","name"]},{name:"type",mapping:["notificationInfo","type"]},{name:"typeShow",mapping:["notificationInfo","typeShow"]},{name:"notificationInfoName",mapping:["notificationInfo","name"]},{name:"notificationProviders",mapping:["notificationProviders"]},{name:"notificationSchedulePlans",mapping:["notificationSchedulePlans"]},{name:"receiverDescription",mapping:["receiverDescription"]},{dataField:"title",mapping:["notificationInfo","title"]},{dataField:"subtitle",mapping:["notificationInfo","subtitle"]},{dataField:"notificationDataFetchEndpoint",mapping:["notificationInfo","notificationDataFetchEndpoint"]},{dataField:"hookEndpoint",mapping:["notificationInfo","hookEndpoint"]},{dataField:"textContent",mapping:["notificationInfo","textContent"]},{dataField:"htmlContent",mapping:["notificationInfo","htmlContent"]},{name:"parseSuccessfulCount",mapping:["notificationInfo","parseSuccessfulCount"]},{name:"parseFailedCount",mapping:["notificationInfo","parseFailedCount"]},{name:"parseCount",mapping:["notificationInfo","parseCount"]},{name:"pushSuccessfulCount",mapping:["notificationInfo","pushSuccessfulCount"]},{name:"pushFailedCount",mapping:["notificationInfo","pushFailedCount"]},{name:"pushCount",mapping:["notificationInfo","pushCount"]},{name:"isFullyFinished",mapping:["notificationInfo","isFullyFinished"]},{name:"isCompletelySuccessful",mapping:["notificationInfo","isCompletelySuccessful"]},{name:"isRepushable",mapping:["isRepushable"]}],k={popup:{title:"::\u901a\u77e5\u5167\u5bb9",showCloseButton:!0,wrapperAttr:{class:"basic-popup"},toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:"85vw",height:"90vh"},form:{colCount:2,items:[{dataField:"title",editorType:"dxTextBox",editorOptions:{disabled:!0}},{dataField:"subtitle",editorType:"dxTextBox",editorOptions:{disabled:!0}},{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox",editorOptions:{disabled:!0}},{dataField:"hookEndpoint",editorType:"dxTextBox",editorOptions:{disabled:!0}},{itemType:"group",name:"CustomContentGroup",cssClass:"CustomContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px",disabled:!0},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{...a(35130).W,height:"240px",disabled:!0},colSpan:5}]}],elementAttr:{class:"basic-form basic-form--readonly"}}};var t=a(19212),T=a(67),g=a(53009),Q=a(72783),S=a(39150),B=a(65343),I=a(27310),E=a(60237),U=a(64133),F=a(16358),D=a(20843),u=a(2173),M=a(25012),f=a(12305),w=a(66403),K=a(86359);const A=()=>({id:!0,name:"\u662f"}),Z=()=>({id:!1,name:"\u5426"}),$=(i,s)=>[i,s],q=()=>({id:null,name:"\u672a\u5b8c\u6210"}),j=(i,s,e)=>[i,s,e];let L=(()=>{class i{constructor(e){this.appRestService=e,this.notificationInfo={parseSuccessfulCount:null,parseFailedCount:null,parseCount:null,pushSuccessfulCount:null,pushFailedCount:null,pushCount:null,isFullyFinished:null,isCompletelySuccessful:null}}ngOnChanges(){this.getData()}getData(){this.notificationInfoId&&this.appRestService.request({method:"GET",url:`/api/app/jbnotifier-admin/notification-grouping-records/${this.notificationInfoId}`}).subscribe(e=>{this.notificationInfo.parseSuccessfulCount=e.notificationInfo.parseSuccessfulCount,this.notificationInfo.parseFailedCount=e.notificationInfo.parseFailedCount,this.notificationInfo.parseCount=e.notificationInfo.parseCount,this.notificationInfo.pushSuccessfulCount=e.notificationInfo.pushSuccessfulCount,this.notificationInfo.pushFailedCount=e.notificationInfo.pushFailedCount,this.notificationInfo.pushCount=e.notificationInfo.pushCount,this.notificationInfo.isFullyFinished=e.notificationInfo.isFullyFinished,this.notificationInfo.isCompletelySuccessful=e.notificationInfo.isCompletelySuccessful})}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(g.$))};static#i=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-notifications-grouping-records-master-detail"]],inputs:{notificationInfoId:"notificationInfoId"},features:[t.TTD],decls:46,vars:24,consts:[[1,"master-detail"],[1,"master-detail-container"],[1,"master-detail-title"],[1,"master-detail-group"],[1,"master-detail-content"],[1,"master-detail-label"],[1,"master-detail-text"],[1,"master-detail-label","master-detail-label--horizontal"],["appRadioGroup","","layout","horizontal",3,"dataSource","value","disabled"]],template:function(o,n){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4,"\u63a8\u9001\u8a18\u9304"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"label",5),t._uU(8,"\u89e3\u6790\u6210\u529f\u6b21\u6578"),t.qZA(),t.TgZ(9,"span",6),t._uU(10),t.qZA()(),t.TgZ(11,"div",4)(12,"label",5),t._uU(13,"\u89e3\u6790\u5931\u6557\u6b21\u6578"),t.qZA(),t.TgZ(14,"span",6),t._uU(15),t.qZA()(),t.TgZ(16,"div",4)(17,"label",5),t._uU(18,"\u89e3\u6790\u7e3d\u6b21\u6578"),t.qZA(),t.TgZ(19,"span",6),t._uU(20),t.qZA()()(),t.TgZ(21,"div",3)(22,"div",4)(23,"label",5),t._uU(24,"\u63a8\u9001\u6210\u529f\u6b21\u6578"),t.qZA(),t.TgZ(25,"span",6),t._uU(26),t.qZA()(),t.TgZ(27,"div",4)(28,"label",5),t._uU(29,"\u63a8\u9001\u5931\u6557\u6b21\u6578"),t.qZA(),t.TgZ(30,"span",6),t._uU(31),t.qZA()(),t.TgZ(32,"div",4)(33,"label",5),t._uU(34,"\u63a8\u9001\u7e3d\u6b21\u6578"),t.qZA(),t.TgZ(35,"span",6),t._uU(36),t.qZA()()(),t.TgZ(37,"div",3)(38,"div",4)(39,"label",7),t._uU(40,"\u5168\u90e8\u7d50\u675f"),t.qZA(),t._UZ(41,"dx-radio-group",8),t.qZA(),t.TgZ(42,"div",4)(43,"label",7),t._uU(44,"\u5b8c\u5168\u6210\u529f"),t.qZA(),t._UZ(45,"dx-radio-group",8),t.qZA()()()()),2&o){let r,l,m,h,x,C;t.xp6(10),t.Oqu(null!==(r=n.notificationInfo.parseSuccessfulCount)&&void 0!==r?r:"null"),t.xp6(5),t.Oqu(null!==(l=n.notificationInfo.parseFailedCount)&&void 0!==l?l:"null"),t.xp6(5),t.Oqu(null!==(m=n.notificationInfo.parseCount)&&void 0!==m?m:"null"),t.xp6(6),t.Oqu(null!==(h=n.notificationInfo.pushSuccessfulCount)&&void 0!==h?h:"null"),t.xp6(5),t.Oqu(null!==(x=n.notificationInfo.pushFailedCount)&&void 0!==x?x:"null"),t.xp6(5),t.Oqu(null!==(C=n.notificationInfo.pushCount)&&void 0!==C?C:"null"),t.xp6(5),t.Q6J("dataSource",t.WLB(14,$,t.DdM(12,A),t.DdM(13,Z)))("value",n.notificationInfo.isFullyFinished)("disabled",!0),t.xp6(4),t.Q6J("dataSource",t.kEZ(20,j,t.DdM(17,A),t.DdM(18,Z),t.DdM(19,q)))("value",n.notificationInfo.isCompletelySuccessful)("disabled",!0)}},dependencies:[w.w,K.I],styles:[".master-detail[_ngcontent-%COMP%]{background-color:var(--dx-master-detail-row-background);padding:3px 20px 16px}.master-detail-container[_ngcontent-%COMP%]{padding:0 24px;background-color:var(--white-1);border:1px solid var(--gray-2);border-radius:5px}.master-detail-title[_ngcontent-%COMP%]{padding:8px 0;border-bottom:1px solid var(--gray-3)}.master-detail-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;font-size:20px;font-weight:600;letter-spacing:var(--letter-2);color:var(--blue-1);margin-bottom:0}.master-detail-content[_ngcontent-%COMP%]{padding:16px 0;flex:1}.master-detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column}.master-detail-label[_ngcontent-%COMP%]{color:var(--gray-2);margin-bottom:8px}.master-detail-label--horizontal[_ngcontent-%COMP%]{color:var(--black-1);margin-bottom:0;margin-right:8px}.master-detail-text[_ngcontent-%COMP%]{display:block;color:var(--black-1);white-space:normal;word-wrap:break-word}.master-detail-group[_ngcontent-%COMP%]{display:flex;gap:16px}.master-detail[_ngcontent-%COMP%]     dx-radio-group{opacity:1}.master-detail[_ngcontent-%COMP%]     dx-radio-group .dx-radiobutton-icon{border:1px solid var(--gray-3)}.master-detail[_ngcontent-%COMP%]     dx-radio-group .dx-radiobutton-icon.dx-radiobutton-icon-checked .dx-radiobutton-icon-dot{background-color:var(--gray-3)}.master-detail[_ngcontent-%COMP%]     dx-radio-group .dx-item-content{color:var(--black-1)}"]})}return i})();const Y=[{name:"notificationSchedulePlan",caption:"\u6642\u9593\u8a08\u756b",dataType:"object",calculateDisplayValue:i=>i.notificationSchedulePlan?i.notificationSchedulePlan.cronDescription?i.notificationSchedulePlan.name?i.notificationSchedulePlan.cronDescription+` (${i.notificationSchedulePlan.name})`:i.notificationSchedulePlan.cronDescription:(i.notificationBackgroundJob.pushTime?(0,c.m)(i.notificationBackgroundJob.pushTime):"")+(i.notificationSchedulePlan.name?i.notificationBackgroundJob.pushTime?` (${i.notificationSchedulePlan.name})`:i.notificationSchedulePlan.name:""):(0,c.m)(i.notificationBackgroundJob.pushTime)+" (\u91cd\u65b0\u767c\u9001)"},{dataField:"isManual",caption:"\u624b\u52d5",dataType:"boolean",calculateCellValue:i=>i.notificationBackgroundJob.isManual},{name:"expectedParseTime",caption:"\u9810\u8a08\u89e3\u6790\u6642\u9593",dataType:"datetime",calculateDisplayValue:i=>(0,c.m)(i.notificationBackgroundJob.expectedParseTime)},{dataField:"isParseFinished",caption:"\u89e3\u6790\u7d50\u675f",dataType:"boolean",calculateCellValue:i=>i.notificationBackgroundJob.isParseFinished},{dataField:"isParseSuccessful",caption:"\u89e3\u6790\u6210\u529f",dataType:"boolean",calculateCellValue:i=>i.notificationBackgroundJob.isParseSuccessful},{name:"pushTime",caption:"\u63a8\u9001\u6642\u9593",dataType:"datetime",calculateDisplayValue:i=>(0,c.m)(i.notificationBackgroundJob.pushTime)},{dataField:"isFullyFinished",caption:"\u5168\u90e8\u7d50\u675f",dataType:"boolean",calculateCellValue:i=>i.notificationBackgroundJob.isFullyFinished},{dataField:"isCompoletelySuccessful",caption:"\u5b8c\u5168\u6210\u529f",dataType:"boolean",calculateCellValue:i=>i.notificationBackgroundJob.isCompletelySuccessful},{name:"logMessages",caption:"Log \u8a0a\u606f",dataType:"string",cellTemplate:"logMessages",fixed:!0,fixedPosition:"right",alignment:"center",width:80}],H=[],P=[{name:"notificationSchedulePlan",mapping:["notificationSchedulePlan"]},{name:"notificationBackgroundJob",mapping:["notificationBackgroundJob"]}],R={index:"/api/app/jbnotifier-admin/notification-grouping-records"};var z=a(10708),X=a(37398),W=a(88762),tt=a(98179),N=a(89267);const it=["grid"],et=()=>({class:"custom-button-icon"});function nt(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",8)(1,"dx-button",9),t.NdJ("onClick",function(){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.showTextContent(r.data.notificationBackgroundJob.logMessages))}),t.qZA()()}2&i&&(t.xp6(),t.Q6J("elementAttr",t.DdM(1,et)))}function ot(i,s){if(1&i&&(t.TgZ(0,"div")(1,"dx-data-grid",3,4)(3,"dxo-toolbar"),t._UZ(4,"dxi-item",5),t.qZA(),t.YNc(5,nt,2,2,"div",6),t.qZA(),t._UZ(6,"app-notification-pager",7),t.qZA()),2&i){const e=t.MAs(2),o=t.oxw();t.xp6(),t.Q6J("datafieldValueQueryStringKeyMapping",o.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",o.dataFieldLookupSourceMapping)("columns",o.columns)("dataSource",o.gridDataSource)("gridProperties",o.gridProperties),t.xp6(4),t.Q6J("dxTemplateOf","logMessages"),t.xp6(),t.Q6J("grid",e)}}const at=()=>({class:"custom-button"});function st(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"dx-button",10),t.NdJ("onClick",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.closePopup())}),t.qZA()()}2&i&&(t.xp6(),t.Q6J("elementAttr",t.DdM(1,at)))}const rt=()=>({toolbar:"bottom",template:"bottom-toolbar"}),lt=i=>[i],ct=()=>({class:"basic-popup"});let dt=(()=>{class i{constructor(e,o,n){this.gridDataSourceService=e,this.appRestService=o,this.configStateService=n,this.isDetailsVisibleChange=new t.vpe,this.columns=Y,this.dataFieldLookupSourceMapping=H,this.relatedDataValueAndQueryStringKeyMapping=P,this.cRUDEndpoints=R,this.isTextContentVisible=!1,this.gridProperties={editing:{allowDeleting:!1,allowUpdating:!1},filterRow:{visible:!1},toolbar:{visible:!1},pager:{visible:!1},height:"85%",elementAttr:{class:"schedule-plan-data-grid schedule-plan-data-grid--grouping-record w-auto"}},this.configStateService.getOne$("currentTenant").subscribe(r=>{this.tenantId=r.id})}ngOnChanges(){this.getDataSource()}getDataSource(){!this.isDetailsVisible||!this.notificationInfoId||(this.gridDataSource=this.gridDataSourceService.getDataSource(R,P,{override:{load:e=>{e.filter=this.gridDataSourceService.getFlattenedFilter(e.filter);const o=this.gridDataSourceService.getSortingString(e);return(0,z.n)(this.appRestService.request({url:`/api/app/jbnotifier-admin/notification-grouping-records/${this.notificationInfoId}/details`,method:"GET",params:{Sorting:o,SpecifiedTenantId:this.tenantId,MaxResultCount:e.take,SkipCount:e.skip}}).pipe((0,X.U)(n=>({data:n.items,totalCount:n.totalCount}))))}}}))}closePopup(){this.isDetailsVisibleChange.emit(!1),this.grid.instance.pageIndex(0)}showTextContent(e){this.isTextContentVisible=!0,this.logMessages=e}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(T.I),t.Y36(g.$),t.Y36(W.XJE))};static#i=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-notifications-grouping-record-details"]],viewQuery:function(o,n){if(1&o&&t.Gf(it,5),2&o){let r;t.iGM(r=t.CRH())&&(n.grid=r.first)}},inputs:{notificationInfoId:"notificationInfoId",isDetailsVisible:"isDetailsVisible"},outputs:{isDetailsVisibleChange:"isDetailsVisibleChange"},features:[t.TTD],decls:4,vars:11,consts:[["title","\u901a\u77e5\u5206\u7d44\u8a18\u9304\u660e\u7d30","width","85vw","height","90vh",3,"visible","toolbarItems","wrapperAttr","visibleChange"],[4,"dxTemplate","dxTemplateOf"],[3,"isTextContentVisible","textContent","isTextContentVisibleChange"],["appGridFeature","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","columns","dataSource","gridProperties"],["grid",""],["name","applyFilterButton","cssClass","d-none"],["class","d-flex justify-content-center",4,"dxTemplate","dxTemplateOf"],[3,"grid"],[1,"d-flex","justify-content-center"],["appCustomButton","","icon","assets/icons/buttons/eye.svg",3,"elementAttr","onClick"],["appCustomButton","","text","\u95dc\u9589",3,"elementAttr","onClick"]],template:function(o,n){1&o&&(t.TgZ(0,"dx-popup",0),t.NdJ("visibleChange",function(l){return n.isDetailsVisible=l}),t.YNc(1,ot,7,7,"div",1)(2,st,2,2,"div",1),t.qZA(),t.TgZ(3,"app-text-content-viewer",2),t.NdJ("isTextContentVisibleChange",function(l){return n.isTextContentVisible=l}),t.qZA()),2&o&&(t.Q6J("visible",n.isDetailsVisible)("toolbarItems",t.VKq(8,lt,t.DdM(7,rt)))("wrapperAttr",t.DdM(10,ct)),t.xp6(),t.Q6J("dxTemplateOf","content"),t.xp6(),t.Q6J("dxTemplateOf","bottom-toolbar"),t.xp6(),t.Q6J("isTextContentVisible",n.isTextContentVisible)("textContent",n.logMessages))},dependencies:[S._,I.A,F.K,D.p6,u.ZT3,tt.x,M.e,u.y1f,f.D,N.Q],styles:[".schedule-plan-data-grid--grouping-record{padding-bottom:0!important}  .schedule-plan-data-grid--grouping-record .dx-datagrid-headers .dx-datagrid-content-fixed .dx-datagrid-table-fixed .dx-header-row td{border-right:0}  .schedule-plan-data-grid--grouping-record .dx-datagrid-rowsview .dx-datagrid-content .dx-datagrid-table.dx-pointer-events-none td.dx-first-cell{border-right:1px solid var(--gray-3)}  .schedule-plan-data-grid--grouping-record .dx-datagrid-rowsview .dx-datagrid-content .dx-datagrid-table.dx-pointer-events-none td:nth-child(2){border-bottom:1px solid var(--gray-4)}  .schedule-plan-data-grid--grouping-record .dx-datagrid-rowsview .dx-datagrid-content .dx-datagrid-table:not(.dx-pointer-events-none) td{border-bottom:1px solid var(--gray-4)}"]})}return i})();const pt=["grid"];function ut(i,s){if(1&i&&t._UZ(0,"app-grid-after-tool-bar",9),2&i){t.oxw();const e=t.MAs(1);t.Q6J("grid",e)}}const gt=()=>({class:"custom-button custom-button--blue"});function ft(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"dx-button",11),t.NdJ("onClick",function(){t.CHM(e),t.oxw();const n=t.MAs(1);return t.KtG(n.instance.cancelEditData())}),t.qZA()()}2&i&&(t.xp6(),t.Q6J("elementAttr",t.DdM(1,gt)))}function mt(i,s){1&i&&t.GkF(0)}const ht=i=>({$implicit:i});function xt(i,s){if(1&i&&(t.ynx(0),t.YNc(1,mt,1,0,"ng-container",12),t.BQk()),2&i){const e=s.$implicit,o=t.oxw().$implicit,n=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",n.templateStore.getGridTemplates(o.key))("ngTemplateOutletContext",t.VKq(2,ht,e))}}function Ct(i,s){if(1&i&&(t.ynx(0),t.YNc(1,xt,2,4,"ng-container",5),t.BQk()),2&i){const e=s.$implicit;t.xp6(),t.Q6J("dxTemplateOf",e.key)}}function _t(i,s){if(1&i&&t._UZ(0,"app-notifications-grouping-records-master-detail",13),2&i){const e=t.oxw();t.Q6J("notificationInfoId",null==e.masterDetailRowCollapseKey?null:e.masterDetailRowCollapseKey.id)}}const bt=()=>({class:"custom-button-icon"});function vt(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"dx-button",14),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.openDetailsTable(r.data.id))}),t.qZA()}2&i&&t.Q6J("elementAttr",t.DdM(1,bt))}function yt(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"app-repush-button",16),t.NdJ("buttonClick",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.repush(n.data.id))}),t.qZA()}}function Tt(i,s){if(1&i&&(t.ynx(0),t.YNc(1,yt,1,0,"app-repush-button",15),t.BQk()),2&i){const e=s.$implicit;t.xp6(),t.Q6J("ngIf",e.data.isRepushable)}}const St=[{path:"",component:(()=>{class i{constructor(e,o,n){this.gridDataSourceService=e,this.appRestService=o,this.templateStore=n,this.columns=J,this.cRUDEndpoints=v,this.dataFieldLookupSourceMapping=O,this.relatedDataValueAndQueryStringKeyMapping=y,this.editingPropertiesForUpdating=k,this.gridProperties={editing:{allowAdding:!1},masterDetail:{enabled:!0,template:"notifications-grouping-records-master-detail"}},this.isDetailsVisible=!1,this.rowExpanded=r=>{this.applyyNotificationMasterDetailRowCollapse(r)}}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(v,y)}ngAfterViewInit(){this.grid.instance.on("rowExpanded",this.rowExpanded)}applyyNotificationMasterDetailRowCollapse(e){setTimeout(()=>{const n=e.element.querySelector('[aria-label="Collapse"]').parentElement.ariaRowIndex;e.element.querySelector(`tr.dx-row.dx-data-row.dx-row-lines[aria-rowindex="${n}"]`).classList.add("master-detail-row-collapse")}),e.key!==this.masterDetailRowCollapseKey&&(e.component.collapseRow(this.masterDetailRowCollapseKey),this.masterDetailRowCollapseKey=e.key)}openDetailsTable(e){this.isDetailsVisible=!0,this.notificationInfoId=e}repush(e){this.appRestService.request({method:"POST",url:`/api/app/jbnotifier-admin/notification-grouping-records/${e}/repush`}).subscribe(()=>{this.grid.instance.refresh()})}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(T.I),t.Y36(g.$),t.Y36(Q.z))};static#i=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-notification-grouping-records"]],viewQuery:function(o,n){if(1&o&&t.Gf(pt,5),2&o){let r;t.iGM(r=t.CRH())&&(n.grid=r.first)}},decls:14,vars:16,consts:[["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForUpdating","columns","dataSource","gridProperties"],["grid",""],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"dxTemplate","dxTemplateOf"],[4,"ngFor","ngForOf"],[3,"notificationInfoId",4,"dxTemplate","dxTemplateOf"],["appCustomButton","","icon","assets/icons/buttons/table-list.svg",3,"elementAttr","click",4,"dxTemplate","dxTemplateOf"],[3,"grid"],[3,"isDetailsVisible","notificationInfoId","isDetailsVisibleChange"],["appCustomButton","","text","\u78ba\u8a8d",3,"elementAttr","onClick"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"notificationInfoId"],["appCustomButton","","icon","assets/icons/buttons/table-list.svg",3,"elementAttr","click"],[3,"buttonClick",4,"ngIf"],[3,"buttonClick"]],template:function(o,n){if(1&o&&(t.TgZ(0,"dx-data-grid",0,1)(2,"dxo-toolbar")(3,"dxi-item",2),t.YNc(4,ut,1,1,"app-grid-after-tool-bar",3),t.qZA(),t._UZ(5,"dxi-item",4),t.qZA(),t.YNc(6,ft,2,2,"div",5)(7,Ct,2,1,"ng-container",6),t.ALo(8,"keyvalue"),t.YNc(9,_t,1,1,"app-notifications-grouping-records-master-detail",7)(10,vt,1,2,"dx-button",8)(11,Tt,2,1,"ng-container",5),t.qZA(),t._UZ(12,"app-notification-pager",9),t.TgZ(13,"app-notifications-grouping-record-details",10),t.NdJ("isDetailsVisibleChange",function(l){return n.isDetailsVisible=l}),t.qZA()),2&o){const r=t.MAs(1);t.Q6J("datafieldValueQueryStringKeyMapping",n.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",n.dataFieldLookupSourceMapping)("editingPropertiesForUpdating",n.editingPropertiesForUpdating)("columns",n.columns)("dataSource",n.gridDataSource)("gridProperties",n.gridProperties),t.xp6(6),t.Q6J("dxTemplateOf","bottom-toolbar"),t.xp6(),t.Q6J("ngForOf",t.lcZ(8,14,n.templateStore.gridTemplates)),t.xp6(2),t.Q6J("dxTemplateOf","notifications-grouping-records-master-detail"),t.xp6(),t.Q6J("dxTemplateOf","grid-table-list-button"),t.xp6(),t.Q6J("dxTemplateOf","repush"),t.xp6(),t.Q6J("grid",r),t.xp6(),t.Q6J("isDetailsVisible",n.isDetailsVisible)("notificationInfoId",n.notificationInfoId)}},dependencies:[d.sg,d.O5,d.tP,S._,B.f,I.A,E.V,U.f,F.K,D.p6,u.ZT3,M.e,u.y1f,f.D,L,dt,d.Nd]})}return i})()}];let It=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275mod=t.oAB({type:i});static#e=this.\u0275inj=t.cJS({imports:[b.Bz.forChild(St),b.Bz]})}return i})();var Ft=a(5533),Dt=a(31610);let Mt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275mod=t.oAB({type:i});static#e=this.\u0275inj=t.cJS({imports:[d.ez,Dt.m,Ft.P,It,f.D,N.Q]})}return i})()}}]);